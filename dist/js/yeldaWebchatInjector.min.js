!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("YeldaChat",[],e):"object"==typeof exports?exports.YeldaChat=e():t.YeldaChat=e()}(window,function(){return(a={},i.m=n={"1AmZ":function(t,e,n){"use strict";n.r(e);var a=n("iCc5"),i=n.n(a),r=n("V7oC"),s=n.n(r);n("c39r");function o(){i()(this,o)}var u=new(s()(o,[{key:"updateQueryStringParameter",value:function(t,e,n){var a=new RegExp("([?&])"+e+"=.*?(&|$)","i"),i=-1!==t.indexOf("?")?"&":"?";return t.match(a)?t.replace(a,"$1"+e+"="+n+"$2"):t+i+e+"="+n}},{key:"createContainer",value:function(t){if(this.webChatContainer)return!0;var e=this.parentContainer===document.body?"yelda_container":"yelda_container inner";this.webChatContainer=document.createElement("div"),this.webChatContainer.setAttribute("id","yelda_container"),this.webChatContainer.setAttribute("class",e),this.parentContainer.appendChild(this.webChatContainer),this.parentContainer===document.body&&this.addAssistantImage(t)}},{key:"addAssistantImage",value:function(t){this.webChatContainer||(this.webChatContainer=document.getElementById("yelda_container")),null===document.getElementById("assistant_img")&&(this.assistantImage=document.createElement("div"),this.assistantImage.setAttribute("id","assistant_img"),this.assistantImage.setAttribute("class","assistant_img default"),this.assistantImage.innerHTML='<i class="fas fa-comment"></i>',this.assistantImage.addEventListener("click",this.openChat),this.updateAssistantImageWithAssistantSettings(t))}},{key:"updateAssistantImageWithAssistantSettings",value:function(t){var e=this,n=new XMLHttpRequest,a=t.assistantUrl+"/assistants/"+t.assistantId+"/chatBubble";n.open("GET",a),n.send(),n.onreadystatechange=function(){if(n.responseText)try{var t=JSON.parse(n.responseText);if(!(t&&t.data&&t.data.hasOwnProperty("isDefaultStyle")&&t.data.image))return void e.webChatContainer.appendChild(e.assistantImage);!t.data.isDefaultStyle&&t.data.image.url&&(document.getElementById("assistant_img").classList.remove("default","custom"),e.assistantImage.innerHTML='<img src="'+t.data.image.url+'" alt="assistant">',document.getElementById("assistant_img").classList.add("custom"),e.webChatContainer.appendChild(e.assistantImage))}catch(t){return void e.webChatContainer.appendChild(e.assistantImage)}else e.webChatContainer.appendChild(e.assistantImage)}}},{key:"createWebChatURL",value:function(t){var e=t.chatUrl;return e=this.updateQueryStringParameter(e,"assistantId",t.assistantId),e=this.updateQueryStringParameter(e,"assistantSlug",t.assistantSlug),e=this.updateQueryStringParameter(e,"locale",t.locale),e=this.updateQueryStringParameter(e,"canBeClosed",t.canBeClosed),e=this.updateQueryStringParameter(e,"shouldBeOpened",t.shouldBeOpened),t.isAdmin&&(e=this.updateQueryStringParameter(e,"isAdmin",t.isAdmin)),t.isStartBtn&&(e=this.updateQueryStringParameter(e,"isStartBtn",t.isAdmin&&t.isStartBtn)),e}},{key:"createWebChatFrame",value:function(t){if(this.webChatContainer||(this.webChatContainer=document.getElementsByClassName("yelda_container")[0]),!this.iframeContainer){var e="yelda_iframe_container";this.iframeContainer=document.createElement("div"),this.iframeContainer.setAttribute("id","yelda_iframe_container"),this.parentContainer!==document.body?e+=" y_active inner":this.iframeContainer.style.cssText="display: none;",this.iframeContainer.setAttribute("class",e),this.webChatContainer.appendChild(this.iframeContainer)}var n=void 0;return this.webChatIframe?n=document.getElementById("web_chat_frame"):((n=document.createElement("iframe")).src=t,n.id="web_chat_frame",n.name="frame",n.style.border="0",n.setAttribute("allow","microphone;"),this.iframeContainer.appendChild(n)),n}},{key:"messageListener",value:function(t){"closeChat"===t.data||"closeChat"===t.message?this.closeChat():"openChat"!==t.data&&"openChat"!==t.message||this.openChat()}},{key:"closeChat",value:function(){var t=document.getElementById("assistant_img");null!==t&&(t.style.display="block");var e=document.getElementById("yelda_iframe_container");null!==e&&(e.classList.remove("y_active"),e.style.display="none")}},{key:"openChat",value:function(){var t=document.getElementById("assistant_img");null!==t&&(t.style.display="none");var e=document.getElementById("yelda_iframe_container");null!==e&&(e.style.display="block",e.classList.add("y_active")),document.getElementById("web_chat_frame").contentWindow.postMessage("openChat","*")}},{key:"toggleFrameListener",value:function(t){var e=0<arguments.length&&void 0!==t&&t,n=!window.addEventListener,a=n?"onmessage":"message",i=window[e?n?"detachEvent":"removeEventListener":n?"attachEvent":"addEventListener"];this.messageListenerBind=this.messageListener.bind(this),i(a,this.messageListenerBind)}},{key:"loadCssAsync",value:function(t){var e=document.getElementsByTagName("head")[0],n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.crossorigin="anonymous",n.href=t+"/static/css/injector.min.css",n.media="all",e.appendChild(n)}},{key:"setUpChatIFrame",value:function(t){var e=this.createWebChatURL(t);this.webChatIframe=this.createWebChatFrame(e)}},{key:"resetChat",value:function(t){this.unLoadChat(),this.setupChat(t)}},{key:"formatData",value:function(t){return t.assistantUrl=t.assistantUrl||"https://app.yelda.ai/",t.chatPath=t.chatPath||"",t.chatUrl=t.assistantUrl+t.chatPath,t.locale=t.locale||"fr_FR",t.isAdmin=!!t.isAdmin,t.isStartBtn=!!t.isStartBtn,t.shouldBeOpened=!!t.shouldBeOpened,t.canBeClosed=!!t.canBeClosed,this.parentContainer=document.body,t.parentContainerId&&document.getElementById(t.parentContainerId)&&(this.parentContainer=document.getElementById(t.parentContainerId),t.canBeClosed=!1),t}},{key:"isStyleSheetLoaded",value:function(){var t=document.styleSheets,e=!1;if(void 0!==t&&t.length)t:for(var n=0;n<t.length;n++){var a=document.styleSheets[n];try{var i=a.cssRules;if(void 0!==i)for(var r=0;r<i.length;r++)if(void 0!==i[r].selectorText&&".assistant_img i"===i[r].selectorText){e=!0;break t}}catch(t){continue}}return e}},{key:"setupChat",value:function(t){if(this.webChatContainer=null,this.iframeContainer=null,this.webChatIframe=null,void 0===(t=this.formatData(t)).assistantId||void 0===t.assistantSlug)return null;this.isStyleSheetLoaded()||this.loadCssAsync(t.assistantUrl),this.createContainer(t),this.setUpChatIFrame(t),this.toggleFrameListener()}},{key:"unLoadChat",value:function(){this.toggleFrameListener(!0),this.iframeContainer&&this.iframeContainer.remove(),this.webChatContainer&&this.webChatContainer.remove(),this.iframeContainer=null,this.webChatIframe=null,this.webChatContainer=null,this.parentContainer=null}},{key:"init",value:function(t){var e=this;if(void 0===t.assistantId||void 0===t.assistantSlug)return null;window.onload=function(){e.setupChat(t)}}}]),o);"undefined"!=typeof window&&(window.yeldaChat=u),e.default=u},"2GTP":function(t,e,n){var r=n("eaoh");t.exports=function(a,i,t){if(r(a),void 0===i)return a;switch(t){case 1:return function(t){return a.call(i,t)};case 2:return function(t,e){return a.call(i,t,e)};case 3:return function(t,e,n){return a.call(i,t,e,n)}}return function(){return a.apply(i,arguments)}}},"2faE":function(t,e,n){var a=n("5K7Z"),i=n("eUtF"),r=n("G8Mo"),s=Object.defineProperty;e.f=n("jmDH")?Object.defineProperty:function(t,e,n){if(a(t),e=r(e,!0),a(n),i)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},"5K7Z":function(t,e,n){var a=n("93I4");t.exports=function(t){if(!a(t))throw TypeError(t+" is not an object!");return t}},"5T2Y":function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},"93I4":function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},"B+OT":function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},G8Mo:function(t,e,n){var i=n("93I4");t.exports=function(t,e){if(!i(t))return t;var n,a;if(e&&"function"==typeof(n=t.toString)&&!i(a=n.call(t)))return a;if("function"==typeof(n=t.valueOf)&&!i(a=n.call(t)))return a;if(!e&&"function"==typeof(n=t.toString)&&!i(a=n.call(t)))return a;throw TypeError("Can't convert object to primitive value")}},Hsns:function(t,e,n){var a=n("93I4"),i=n("5T2Y").document,r=a(i)&&a(i.createElement);t.exports=function(t){return r?i.createElement(t):{}}},KUxP:function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},NegM:function(t,e,n){var a=n("2faE"),i=n("rr1i");t.exports=n("jmDH")?function(t,e,n){return a.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},"RU/L":function(t,e,n){n("Rqdy");var a=n("WEpk").Object;t.exports=function(t,e,n){return a.defineProperty(t,e,n)}},Rqdy:function(t,e,n){var a=n("Y7ZC");a(a.S+a.F*!n("jmDH"),"Object",{defineProperty:n("2faE").f})},SEkw:function(t,e,n){t.exports={default:n("RU/L"),__esModule:!0}},V7oC:function(t,e,n){"use strict";e.__esModule=!0;var a,i=n("SEkw"),r=(a=i)&&a.__esModule?a:{default:a};function s(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,r.default)(t,a.key,a)}}e.default=function(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}},WEpk:function(t,e){var n=t.exports={version:"2.6.1"};"number"==typeof __e&&(__e=n)},Y7ZC:function(t,e,n){var p=n("5T2Y"),y=n("WEpk"),C=n("2GTP"),v=n("NegM"),g=n("B+OT"),b="prototype",w=function(t,e,n){var a,i,r,s=t&w.F,o=t&w.G,u=t&w.S,c=t&w.P,l=t&w.B,d=t&w.W,f=o?y:y[e]||(y[e]={}),h=f[b],m=o?p:u?p[e]:(p[e]||{})[b];for(a in o&&(n=e),n)(i=!s&&m&&void 0!==m[a])&&g(f,a)||(r=i?m[a]:n[a],f[a]=o&&"function"!=typeof m[a]?n[a]:l&&i?C(r,p):d&&m[a]==r?function(a){function t(t,e,n){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(t);case 2:return new a(t,e)}return new a(t,e,n)}return a.apply(this,arguments)}return t[b]=a[b],t}(r):c&&"function"==typeof r?C(Function.call,r):r,c&&((f.virtual||(f.virtual={}))[a]=r,t&w.R&&h&&!h[a]&&v(h,a,r)))};w.F=1,w.G=2,w.S=4,w.P=8,w.B=16,w.W=32,w.U=64,w.R=128,t.exports=w},c39r:function(t,e,n){},eUtF:function(t,e,n){t.exports=!n("jmDH")&&!n("KUxP")(function(){return 7!=Object.defineProperty(n("Hsns")("div"),"a",{get:function(){return 7}}).a})},eaoh:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},iCc5:function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},jmDH:function(t,e,n){t.exports=!n("KUxP")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},rr1i:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}}},i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s="1AmZ")).default;function i(t){if(a[t])return a[t].exports;var e=a[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}var n,a});
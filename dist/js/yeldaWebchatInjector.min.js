!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("YeldaChat",[],t):"object"==typeof exports?exports.YeldaChat=t():e.YeldaChat=t()}(window,function(){return(a={},i.m=n={"1AmZ":function(e,t,n){"use strict";n.r(t);var a=n("iCc5"),i=n.n(a),r=n("V7oC"),s=n.n(r);n("c39r");function o(){i()(this,o)}var u=new(s()(o,[{key:"updateQueryStringParameter",value:function(e,t,n){var a=new RegExp("([?&])"+t+"=.*?(&|$)","i"),i=-1!==e.indexOf("?")?"&":"?";return e.match(a)?e.replace(a,"$1"+t+"="+n+"$2"):e+i+t+"="+n}},{key:"createContainer",value:function(e){if(this.webChatContainer)return!0;var t=this.parentContainer===document.body?"yelda_container":"yelda_container inner";this.webChatContainer=document.createElement("div"),this.webChatContainer.setAttribute("id","yelda_container"),this.webChatContainer.setAttribute("class",t),this.parentContainer.appendChild(this.webChatContainer),this.parentContainer===document.body&&this.addAssistantImage(e)}},{key:"addAssistantImage",value:function(e){this.webChatContainer||(this.webChatContainer=document.getElementById("yelda_container")),null===document.getElementById("assistant_img")&&(this.assistantImage=document.createElement("div"),this.assistantImage.setAttribute("id","assistant_img"),this.assistantImage.setAttribute("class","assistant_img default"),this.assistantImage.innerHTML='<i class="fas fa-comment"></i>',this.assistantImage.addEventListener("click",this.openChat),this.updateAssistantImageWithAssistantSettings(e))}},{key:"isMobile",value:function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/iPhone|iPad|iPod/i)||navigator.userAgent.match(/Opera Mini/i)||navigator.userAgent.match(/IEMobile/i)}},{key:"updateAssistantImageWithAssistantSettings",value:function(e){var n=this,a=new XMLHttpRequest,t=e.assistantUrl+"/assistants/"+e.assistantId+"/chatBubble";a.open("GET",t),a.send(),a.onreadystatechange=function(){if(a.responseText)try{var e=JSON.parse(a.responseText);if(!(e&&e.data&&e.data.hasOwnProperty("isDefaultStyle")&&e.data.image))return void n.webChatContainer.appendChild(n.assistantImage);if(!e.data.isDefaultStyle&&e.data.image.url){var t=n.isMobile()&&e.data.mobileImage&&e.data.mobileImage.url?e.data.mobileImage.url:e.data.image.url;document.getElementById("assistant_img").classList.remove("default","custom"),n.assistantImage.innerHTML='<img src="'+t+'" alt="assistant">',document.getElementById("assistant_img").classList.add("custom"),n.webChatContainer.appendChild(n.assistantImage)}}catch(e){return void n.webChatContainer.appendChild(n.assistantImage)}else n.webChatContainer.appendChild(n.assistantImage)}}},{key:"createWebChatURL",value:function(e){var t=e.chatUrl;return t=this.updateQueryStringParameter(t,"assistantId",e.assistantId),t=this.updateQueryStringParameter(t,"assistantSlug",e.assistantSlug),t=this.updateQueryStringParameter(t,"locale",e.locale),e.hasOwnProperty("canBeClosed")&&(t=this.updateQueryStringParameter(t,"canBeClosed",e.canBeClosed)),e.hasOwnProperty("shouldBeOpened")&&(t=this.updateQueryStringParameter(t,"shouldBeOpened",e.shouldBeOpened)),e.isAdmin&&(t=this.updateQueryStringParameter(t,"isAdmin",e.isAdmin)),e.isStartBtn&&(t=this.updateQueryStringParameter(t,"isStartBtn",e.isAdmin&&e.isStartBtn)),t}},{key:"createWebChatFrame",value:function(e){if(this.webChatContainer||(this.webChatContainer=document.getElementsByClassName("yelda_container")[0]),!this.iframeContainer){var t="yelda_iframe_container";this.iframeContainer=document.createElement("div"),this.iframeContainer.setAttribute("id","yelda_iframe_container"),this.parentContainer!==document.body?t+=" y_active inner":this.iframeContainer.style.cssText="display: none;",this.iframeContainer.setAttribute("class",t),this.webChatContainer.appendChild(this.iframeContainer)}var n=void 0;return this.webChatIframe?n=document.getElementById("web_chat_frame"):((n=document.createElement("iframe")).src=e,n.id="web_chat_frame",n.name="frame",n.style.border="0",n.setAttribute("allow","microphone;"),n.setAttribute("allowfullscreen","true"),n.setAttribute("webkitallowfullscreen","true"),n.setAttribute("mozallowfullscreen","true"),this.iframeContainer.appendChild(n)),n}},{key:"messageListener",value:function(e){"closeChat"===e.data||"closeChat"===e.message?this.closeChat():"openChat"!==e.data&&"openChat"!==e.message||this.openChat()}},{key:"closeChat",value:function(){var e=document.getElementById("assistant_img");null!==e&&(e.style.display="block");var t=document.getElementById("yelda_iframe_container");null!==t&&(t.classList.remove("y_active"),t.style.display="none")}},{key:"openChat",value:function(){var e=document.getElementById("assistant_img");null!==e&&(e.style.display="none");var t=document.getElementById("yelda_iframe_container");null!==t&&(t.style.display="block",t.classList.add("y_active")),document.getElementById("web_chat_frame").contentWindow.postMessage("openChat","*")}},{key:"toggleFrameListener",value:function(e){var t=0<arguments.length&&void 0!==e&&e,n=!window.addEventListener,a=n?"onmessage":"message",i=window[t?n?"detachEvent":"removeEventListener":n?"attachEvent":"addEventListener"];this.messageListenerBind=this.messageListener.bind(this),i(a,this.messageListenerBind)}},{key:"loadCssAsync",value:function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.crossorigin="anonymous",n.href=e+"/static/css/yeldaWebchatInjector.min.css",n.media="all",t.appendChild(n)}},{key:"setUpChatIFrame",value:function(e){var t=this.createWebChatURL(e);this.webChatIframe=this.createWebChatFrame(t)}},{key:"resetChat",value:function(e){this.unLoadChat(),this.setupChat(e)}},{key:"formatData",value:function(e){return e.assistantUrl=e.assistantUrl||"https://app.yelda.ai/",e.chatPath=e.chatPath||"",e.chatUrl=e.assistantUrl+e.chatPath,e.locale=e.locale||"fr_FR",e.isAdmin=!!e.isAdmin,e.isStartBtn=!!e.isStartBtn,e.hasOwnProperty("shouldBeOpened")&&(e.shouldBeOpened=!!e.shouldBeOpened),e.hasOwnProperty("canBeClosed")&&(e.canBeClosed=!!e.canBeClosed),this.parentContainer=document.body,e.parentContainerId&&document.getElementById(e.parentContainerId)&&(this.parentContainer=document.getElementById(e.parentContainerId),e.canBeClosed=!1),e}},{key:"isStyleSheetLoaded",value:function(){var e=document.styleSheets,t=!1;if(void 0!==e&&e.length)e:for(var n=0;n<e.length;n++){var a=document.styleSheets[n];try{var i=a.cssRules;if(void 0!==i)for(var r=0;r<i.length;r++)if(void 0!==i[r].selectorText&&".assistant_img"===i[r].selectorText){t=!0;break e}}catch(e){continue}}return t}},{key:"setupChat",value:function(e){if(this.webChatContainer=null,this.iframeContainer=null,this.webChatIframe=null,void 0===(e=this.formatData(e)).assistantId||void 0===e.assistantSlug)return null;this.isStyleSheetLoaded()||this.loadCssAsync(e.assistantUrl),this.createContainer(e),this.setUpChatIFrame(e),this.toggleFrameListener()}},{key:"unLoadChat",value:function(){this.toggleFrameListener(!0),this.iframeContainer&&this.iframeContainer.remove(),this.webChatContainer&&this.webChatContainer.remove(),this.iframeContainer=null,this.webChatIframe=null,this.webChatContainer=null,this.parentContainer=null}},{key:"init",value:function(e){var t=this;if(void 0===e.assistantId||void 0===e.assistantSlug)return null;window.onload=function(){t.setupChat(e)}}}]),o);"undefined"!=typeof window&&(window.yeldaChat=u),t.default=u},"2GTP":function(e,t,n){var r=n("eaoh");e.exports=function(a,i,e){if(r(a),void 0===i)return a;switch(e){case 1:return function(e){return a.call(i,e)};case 2:return function(e,t){return a.call(i,e,t)};case 3:return function(e,t,n){return a.call(i,e,t,n)}}return function(){return a.apply(i,arguments)}}},"2faE":function(e,t,n){var a=n("5K7Z"),i=n("eUtF"),r=n("G8Mo"),s=Object.defineProperty;t.f=n("jmDH")?Object.defineProperty:function(e,t,n){if(a(e),t=r(t,!0),a(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},"5K7Z":function(e,t,n){var a=n("93I4");e.exports=function(e){if(!a(e))throw TypeError(e+" is not an object!");return e}},"5T2Y":function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},"93I4":function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},"B+OT":function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},G8Mo:function(e,t,n){var i=n("93I4");e.exports=function(e,t){if(!i(e))return e;var n,a;if(t&&"function"==typeof(n=e.toString)&&!i(a=n.call(e)))return a;if("function"==typeof(n=e.valueOf)&&!i(a=n.call(e)))return a;if(!t&&"function"==typeof(n=e.toString)&&!i(a=n.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},Hsns:function(e,t,n){var a=n("93I4"),i=n("5T2Y").document,r=a(i)&&a(i.createElement);e.exports=function(e){return r?i.createElement(e):{}}},KUxP:function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},NegM:function(e,t,n){var a=n("2faE"),i=n("rr1i");e.exports=n("jmDH")?function(e,t,n){return a.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},"RU/L":function(e,t,n){n("Rqdy");var a=n("WEpk").Object;e.exports=function(e,t,n){return a.defineProperty(e,t,n)}},Rqdy:function(e,t,n){var a=n("Y7ZC");a(a.S+a.F*!n("jmDH"),"Object",{defineProperty:n("2faE").f})},SEkw:function(e,t,n){e.exports={default:n("RU/L"),__esModule:!0}},V7oC:function(e,t,n){"use strict";t.__esModule=!0;var a,i=n("SEkw"),r=(a=i)&&a.__esModule?a:{default:a};function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,r.default)(e,a.key,a)}}t.default=function(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}},WEpk:function(e,t){var n=e.exports={version:"2.6.1"};"number"==typeof __e&&(__e=n)},Y7ZC:function(e,t,n){var p=n("5T2Y"),y=n("WEpk"),C=n("2GTP"),v=n("NegM"),g=n("B+OT"),b="prototype",w=function(e,t,n){var a,i,r,s=e&w.F,o=e&w.G,u=e&w.S,l=e&w.P,c=e&w.B,d=e&w.W,f=o?y:y[t]||(y[t]={}),h=f[b],m=o?p:u?p[t]:(p[t]||{})[b];for(a in o&&(n=t),n)(i=!s&&m&&void 0!==m[a])&&g(f,a)||(r=i?m[a]:n[a],f[a]=o&&"function"!=typeof m[a]?n[a]:c&&i?C(r,p):d&&m[a]==r?function(a){function e(e,t,n){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(e);case 2:return new a(e,t)}return new a(e,t,n)}return a.apply(this,arguments)}return e[b]=a[b],e}(r):l&&"function"==typeof r?C(Function.call,r):r,l&&((f.virtual||(f.virtual={}))[a]=r,e&w.R&&h&&!h[a]&&v(h,a,r)))};w.F=1,w.G=2,w.S=4,w.P=8,w.B=16,w.W=32,w.U=64,w.R=128,e.exports=w},c39r:function(e,t,n){},eUtF:function(e,t,n){e.exports=!n("jmDH")&&!n("KUxP")(function(){return 7!=Object.defineProperty(n("Hsns")("div"),"a",{get:function(){return 7}}).a})},eaoh:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},iCc5:function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},jmDH:function(e,t,n){e.exports=!n("KUxP")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},rr1i:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}}},i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s="1AmZ")).default;function i(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var n,a});